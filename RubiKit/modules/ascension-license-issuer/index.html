<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Ascension License Issuer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="card" title="This tool creates signed, offline licenses for Ascension using RSA XML keys. No network required.">
    <h1>Ascension License Issuer (Offline · RSA XML)</h1>

    <!-- HOW-TO PANEL -->
    <section class="section" aria-label="How to use">
      <details open>
        <summary>How it works & quick start</summary>
        <ol class="howto">
          <li><strong>Make or load your RSA PRIVATE key</strong> below. You can generate one here (XML) or paste an existing <code>&lt;RSAKeyValue&gt;</code> and click <strong>Import</strong>.</li>
          <li>Click <strong>Copy Public Key (XML)</strong> and paste it into the plugin’s <code>PublicKeyXml</code> constant (then rebuild).</li>
          <li>Set a <strong>Build Salt</strong> (generate here or paste your existing one). This value must match the plugin.</li>
          <li>Enter a <strong>character name</strong> and choose a <strong>license time</strong> (≤ 12 hours). Click <strong>Sign Token</strong> and paste it in-game.</li>
        </ol>
      </details>
    </section>

    <!-- KEY MANAGEMENT -->
    <section class="section">
      <h3>Key Management (RSA XML)</h3>

      <div class="row" title="Generate a new 2048-bit RSA keypair in your browser. Private stays local if 'remember' is checked.">
        <button id="genRsa">Generate New RSA Keypair (2048)</button>
        <button id="copyPrivXml" title="Copy the PRIVATE KEY XML currently loaded (or generated).">Copy Private Key (XML)</button>
        <button id="copyPubXml" title="Copy PUBLIC KEY XML derived from the private key. Use this in the plugin.">Copy Public Key (XML)</button>
        <button id="exportPrivXml" title="Download PRIVATE KEY XML to a file. Keep it secret.">Export Private Key</button>
        <button id="exportPubXml" title="Download PUBLIC KEY XML to a file.">Export Public Key</button>
      </div>

      <div class="row">
        <textarea id="privXml" rows="8"
          placeholder="Paste PRIVATE KEY XML here (full &lt;RSAKeyValue&gt; with D, P, Q, DP, DQ, InverseQ) to import, or leave empty and click 'Generate New RSA Keypair'."
          title="Paste the PRIVATE KEY XML (includes D, P, Q, DP, DQ, InverseQ)."></textarea>
      </div>

      <div class="row">
        <button id="importPrivXml" title="Import PRIVATE KEY from the XML above for signing.">Import Private Key (XML)</button>
        <label title="If checked, the private key XML is stored in localStorage on this device.">
          <input type="checkbox" id="remember" checked /> remember in this browser
        </label>
      </div>

      <div id="keystatus" class="status">No key loaded.</div>

      <div class="row">
        <textarea id="pubXmlOut" rows="4" readonly
          placeholder="Public key XML will appear here after copy/export."
          title="This is the PUBLIC KEY XML that must be in the plugin."></textarea>
      </div>
    </section>

    <!-- SALT BUILDER -->
    <section class="section" aria-label="Salt Builder">
      <h3>Build Salt</h3>
      <div class="row">
        <input id="buildSalt" type="text"
               title="Shared secret used to compute tick. Must match the plugin constant exactly."
               placeholder="Build salt (GUID or random hex)."/>
        <button id="genSaltGuid" title="Generate a random GUID salt.">Generate GUID</button>
        <button id="genSaltHex" title="Generate 32 random bytes as hex.">Generate 32B Hex</button>
        <button id="copySalt" title="Copy current salt to clipboard.">Copy Salt</button>
      </div>
      <small class="status">Set this to the same value in your plugin’s <code>BuildSalt</code> constant.</small>
    </section>

    <!-- LICENSE ISSUE -->
    <section class="section">
      <h3>Issue License</h3>

      <div class="row">
        <label title="Exact in-game character name.">Character</label>
        <input id="character" placeholder="Exact character name" title="Type the exact character name the license is for." />
      </div>

      <div class="row" title="Set a duration up to 12 hours total (hours + minutes).">
        <label>License Time</label>
        <div class="row time-row">
          <input id="hours" type="number" min="0" max="12" value="1" style="max-width:110px"
                 title="Hours (0–12). Total time will be capped at 12 hours." />
         
